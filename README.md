
# <a id="глоссарий-системы-дбо-v3.1"></a>Глоссарий системы ДБО 

###   
  
  
1\. Основные определения  
  
1\.1 Услуга ДБО  


__Определение:__  
Банковский продукт или продукт других пользователей, доступный для подключения и использования в системе дистанционного обслуживания\.

__Виды:__   
\- Разового списания и разового оказания услуги  
\- Множественного списания и множественного оказания услуги

__Ограничения:__   
\- Может быть временно заблокирована оператором  
\- Могут быть заблокированы пользователи для подключения к услуге\.  
  
__Характеристики:__   
\- Данные пользователя\-создателя \(текстовое поле\)  
\- Для корпоративных пользователей \(Да/Нет\) \(Уязвимость 4\)  
\- Описание\(текстовое поле\)  
\- Дата и время создания\(время\)  
\- Цена услуги\(число\)  
\- Статус услуги \(пункт 1\.2\)  
\- Список заблокированных пользователей \(массив\)

### 1\.2 Статус услуги ДБО

__Определение:__  
Статус услуги которая влияет на возможность использования услуги\.

__Виды:__   
\- Активная \(активна и __ВИДНА __для всех\)  
\- Заблокированная \(неактивна и __СКРЫТА__ для всех\)

### 1\.3 Заявка на услугу ДБО

__Определение:__  
Формальный запрос пользователя на подключение или создание новой услуги в системе ДБО

__Характеристики:__   
\- Данные пользователя  
\- Вид услуги  
\- Описание  
\- Дата и время создания  
\- Цена услуги  
\- Статус услуги

__Не может:__   
\- Создавать других операторов   
\- Изменять системные настройки

### 1\.4 Счёт

__Определение:__  
Уникальная учётная запись в банковской системе, отражающая денежные обязательства банка перед клиентом\.  
  
__ Реквизиты:__  
\- 20\-значный номер \(для РФ\)  
\- Валюта счёта  
\- Текущий баланс  
\- Дата открытия

### 1\.5 Банковская карта

__Определение:__  
Платёжный инструмент, привязанный к счёту клиента, позволяющий проводить операции через ДБО\.

### __Характеристики:  
__\- Номер карты \(16\-19 цифр\)  
\- Срок действия  
\- CVV/CVC код  
\- Имя держателя  
\- Валюта  
  
1\.6 Платёж

__Определение:__  
Операция перечисления средств с одного счёта на другой\.

__Характеристики:  
\- __Время платежа__  
__\- Номер счёта\-источника  
\- Номер счёта\-получателя  
\- Сумма перевода  
\- Назначение  
\- Валюта  


## <a id="основные-роли-в-системе"></a>2\. Основные роли в системе

### <a id="пользователь-дбо"></a>2\.1 Пользователь ДБО

__Определение:__  
Клиент системы дистанционного банковского обслуживания\. Он может быть клиентом услуг, подавать заявки на создание своих услуг\.

__Функции:__   
\- Подключение услуг к своей УЗ  
\- Подача заявок на создание услуг    
\- Доступ к личному кабинет  
\- Переводы денежных средств\.

__Ограничения:__   
  
\- Может быть временно заблокирован оператором

### <a id="оператор-дбо"></a>2\.2 Оператор ДБО

__Определение:__  
Модератор системы дистанционного банковского обслуживания\.

__Функции:__   
\- Модерация контента  
\- Одобрение/отклонение заявок на создание услуги \(Уязвимость 2 / Уязвимость 3\)  
\- Временная блокировка клиентов   
\- Назначение ограничений пользователям \(запрет подключения к конкретной услуге\)

__Не может:__   
\- Создавать других операторов   
\- Изменять системные настройки

### <a id="администратор-дбо"></a>2\.3 Администратор ДБО

__Определение:__  
Суперпользователь системы\.

__Функции \(включая все возможности оператора\):__ \-  
\- Создание/удаление учетных записей операторов   
\- Настройка системных параметров  
\- Управление правами доступа  
\- Просмотр логов событий систем ДБО \(каждая операция системы ДБО будет логироваться на прикладном уровне в отдельный журнал\)

### <a id="разработчик-дбо"></a>2\.4 Разработчик ДБО

__Определение:__  
Технический специалист с доступом к коду\.  
  
__Особенности:  
__ \- Работает с исходным кодом системы ДБО \(Уязвимость 1\)   
\- Может не иметь УЗ в продакшн\-системе <a id="иерархия-прав"></a>  
  
__  
  
УЯЗВИМОСТИ И ИХ ПОСЛЕДСТВИЯ \(сортировка по времени реализации злоумышленником\)  
__  
  
__Уязвимость 1: Компрометация учетных данных разработчика через вредоносный Git\-хук__

1. Разработчик клонирует вредоносный репозиторий, содержащий вредоносный хуk \.git/hooks/post\-merge\.
2. Хук находит файл \.env с паролем от почтовой УЗ Mailu:
3. Пароль отправляется злоумышленнику через DNS\-туннелирование:

__Почему это работает:__

- __Отсутствие мониторинга хуков__ – никто не проверяет содержимое \.git/hooks/\.
- __Пароль дает полный доступ к БД__ – учетная запись postgres имеет права SUPERUSER\.

__Правильное устранение__

1. __Запретить локальные хуки__

### __Последствие 1 к Уязвимость 1:  
 Прямое обращение к PostgreSQL__

#### __Правильное устранение последствий__

1. __Сброс пароля БД:__
2. __Восстановление данных из бэкапа:__

### __Последствие 2 к Уязвимость 1:  
 Отправка вредоносного письма Оператору ДБО__

#### __Правильное устранение последствий__

- 
	1. __Изменение пароля от почтовой УЗ:__

  
  
__Уязвимость 2: Фишинговая рассылка Оператору ДБО от разработчика ДБО __  
  
  
Оператор получает письмо "Срочное обновление политики безопасности ДБО" с вложением Security\_Update\.exe\. Письмо через внутреннюю коммуникацию Mailu  
 __  
 Что происходит:__

### 1\) Злоумышленник Получает reverse\-shell на пк Оператора\.

### 2\) Создает новую УЗ для оператора \(злоумышленника\) ДБО:

### __ Почему это работает?__

- __Отсутствие анти\-спам фильтра на Mailu__

__Правильное устранение  
__

- Включить фильтр спама/безопасности на Mailu

__Последствие 1 к Уязвимости 2__

__Revesre\-shell на ПК оператора ДБО__

__Правильное устранение__

- Удаление ВПО с пк Оператора

  
  
  
__Уязвимость 3: Автоматическое подтверждение заявки на создание услуги__  
  
__Вариант 1 \- XSS в описании услуги:  
__

Злоумышленник может внедрить JavaScript\-код в название услуги, который выполнится в браузере оператора при просмотре заявки\.

__Что происходит:__

1. Атакующий создает услугу с названием, содержащую js\.
2. Оператор открывает страницу заявки в панели оператора\(автоматизировано\)\.
3. Браузер оператора автоматически перенаправляется на /validate\_service/123/ \(где 123 — ID услуги, которую нужно подтвердить\)\.
4. Если валидация работает через GET\-запросы \(без подтверждения\), услуга автоматически подтверждается\.

### __Почему это работает?__

- __Нет экранирования HTML/JS__ в шаблонах Django \(\{\{ service\.name \}\} вместо \{\{ service\.name|escape \}\}\)\.
- __GET\-запросы изменяют состояние__ \(вместо POST\)
- __Нет CSRF\-защиты__ или подтверждения действия\.  
  
__Вариант 2 \- IDOR в валидации услуги:__

Злоумышленник может подтвердить __любую__ услугу, даже если он не оператор или услуга ему не принадлежит\.  
  
__Что происходит:__

1. Атакующий узнаёт ID чужой услуги \(например, через XSS, перебор или утечку данных\)\.
2. Отправляет запрос на валидацию, даже не будучи оператором\.
3. Услуга подтверждается без проверок\.

### __Почему это работает?__

- __Нет проверки прав доступа__ \(if not request\.user\.is\_operator\)\.  


__Правильный способ закрытия Уязвимости :  
  
1\)__Устранение уязвимости на back\-end__  
  
Неправильный способ закрытия Уязвимости:__

1. Удаление услуги \(хакер заново создаст такую услугу\)
2. Блокировка пользователя \(хакер создаст новый аккаунт\)__  
__  
  
__Последствие уязвимости 1 \(Вариант 1\)  
__Боты\-пользователи будут покупать услугу, а злоумышленник будет получать прибыл

__Правильный способ закрытия Последствия :  
__1\) После устарения Уязвимости – удалить аккаунт злоумышленника\+ его услугу

__Неправильный способ закрытия Последствия:__  
1\) Удалять аккаунт злоумышленника и услугу до фикса уязвимости  


__Последствие уязвимости 1 \(Вариант 2\)  
Злоумышленник __подменяет содержимое__ уже подтвержденной __услуги

__  
Правильный способ закрытия Последствия:  
__1\) После устарения Уязвимости найти измененные услуги через журнал аудита

### __Неправильный способ закрытия Последствия:__  
1\) Удалять услугу \(она не пересоздаётся\)

### __Уязвимость 4: SQL\-инъекция в фильтре для отображения скрытых корпоративных услуг __

#### __Вариант 1 \- Уязвимость в поиске по категориям__

__Механизм:__

1. Система ДБО позволяет фильтровать услуги по категориям через параметр category\_id\.
2. Внутренний запрос формируется напрямую из пользовательского ввода:
3. Атакующий передает вредоносный параметр:
4. Сервер выполняет запрос с SQLi

__Почему это работает?__

- Отсутствует валидация входных данных
- Используется конкатенация строк вместо параметризованных запросов
- Нет ограничений на специальные символы \(OR, \-\-\)

#### __Вариант 2 \- Уязвимость в полнотекстовом поиске__

__Механизм:__

1. Поиск услуг по названию использует прямой SQL\-запрос:

search\_term = request\.GET\.get\('search'\)

query = f"SELECT \* FROM services WHERE name LIKE '%\{search\_term\}%'"

1. Атакующий вводит SQLi
2. Сервер возвращает данные

__Почему это работает?__

- Отсутствует экранирование пользовательского ввода
- Система не проверяет структуру запроса

### __Правильный способ закрытия уязвимости__

1. Использование ORM Django:
2. Параметризованные запросы:
3. Валидация входных данных:
4. Проверка использования скрытых услуг только специальным пользователям \(работникам ДБО\) 

### __Неправильные способы закрытия__

1. Частичное экранирование кавычек \(не защищает от OR 1=1\)
2. Удаление “скрытых” услуг
3. Отключение функционала поиска

### __Последствие уязвимости \(Вариант 1\)__

__Раскрытие и использование услуг по заниженным ценам для “своих”__

__Правильное устранение последствий:__

1. Удаление хакера из списка пользователей скрытой услуги

__Неправильное устранение:__

1. Удаление скрытых услуг
2. Временное отключение каталога


