<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Система ДБО "ФинансПро" - Техническая документация</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f8f9fa;
        }
        
        .container {
            background-color: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            border-bottom: 3px solid #1e40af;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .title {
            color: #1e40af;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .subtitle {
            color: #6b7280;
            font-size: 1.2em;
            margin-bottom: 20px;
        }
        
        .meta-info {
            background-color: #f8fafc;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        h1 {
            color: #1e40af;
            font-size: 1.8em;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        
        h2 {
            color: #374151;
            font-size: 1.4em;
            margin-top: 25px;
        }
        
        h3 {
            color: #4b5563;
            font-size: 1.2em;
            margin-top: 20px;
        }
        
        .code-block {
            background-color: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .table th {
            background-color: #1e40af;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }
        
        .table td {
            padding: 12px;
            border: 1px solid #e5e7eb;
        }
        
        .table tr:nth-child(even) {
            background-color: #f8fafc;
        }
        
        ul {
            margin: 15px 0;
            padding-left: 25px;
        }
        
        li {
            margin: 8px 0;
        }
        
        .highlight {
            background-color: #fef3c7;
            padding: 2px 4px;
            border-radius: 3px;
        }
        
        .warning {
            background-color: #fef2f2;
            border: 1px solid #fecaca;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .success {
            background-color: #f0fdf4;
            border: 1px solid #bbf7d0;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e5e7eb;
            color: #6b7280;
        }
        
        @media print {
            body {
                background-color: white;
            }
            .container {
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">Система Дистанционного<br>Банковского Обслуживания</h1>
            <p class="subtitle">Техническая документация</p>
            
            <div class="meta-info">
                <strong>Версия:</strong> 1.0<br>
                <strong>Дата:</strong> 22.10.2025<br>
                <strong>Автор:</strong> Система ДБО "ФинансПро"<br>
                <strong>Статус:</strong> Активная разработка
            </div>
        </div>

        <h1>Содержание</h1>
        <ul>
            <li><a href="#overview">1. Обзор системы</a></li>
            <li><a href="#architecture">2. Архитектура</a></li>
            <li><a href="#models">3. Модели данных</a></li>
            <li><a href="#api">4. API и эндпоинты</a></li>
            <li><a href="#security">5. Безопасность</a></li>
            <li><a href="#installation">6. Установка и настройка</a></li>
            <li><a href="#administration">7. Администрирование</a></li>
            <li><a href="#testing">8. Тестирование</a></li>
            <li><a href="#deployment">9. Развертывание</a></li>
        </ul>

        <h1 id="overview">1. Обзор системы</h1>
        
        <p>Система Дистанционного Банковского Обслуживания (ДБО) "ФинансПро" представляет собой современную веб-платформу для управления банковскими услугами онлайн. Система построена на Django и предоставляет полный спектр банковских операций через веб-интерфейс.</p>

        <h2>Основные возможности</h2>
        <ul>
            <li><strong>Управление клиентами:</strong> Регистрация, верификация и управление клиентскими данными</li>
            <li><strong>Банковские услуги:</strong> Каталог услуг с возможностью подключения и управления</li>
            <li><strong>Финансовые операции:</strong> Переводы, платежи, депозиты, кредиты</li>
            <li><strong>Инвестиционные продукты:</strong> Управление инвестиционными портфелями</li>
            <li><strong>Безопасность:</strong> Многоуровневая система безопасности с логированием атак</li>
            <li><strong>Администрирование:</strong> Панели управления для операторов и администраторов</li>
        </ul>

        <h2>Технологический стек</h2>
        <table class="table">
            <tr>
                <th>Компонент</th>
                <th>Технология</th>
            </tr>
            <tr>
                <td>Backend</td>
                <td>Django 5.2.7, Python 3.13</td>
            </tr>
            <tr>
                <td>Database</td>
                <td>SQLite (разработка), PostgreSQL (продакшн)</td>
            </tr>
            <tr>
                <td>Frontend</td>
                <td>HTML5, CSS3, JavaScript, daisyUI 5</td>
            </tr>
            <tr>
                <td>Стилизация</td>
                <td>Tailwind CSS 4</td>
            </tr>
            <tr>
                <td>Безопасность</td>
                <td>Django Security Framework</td>
            </tr>
        </table>

        <h1 id="architecture">2. Архитектура</h1>
        
        <p>Система построена по принципу MVC (Model-View-Controller) с использованием Django Framework. Архитектура обеспечивает разделение ответственности между компонентами и упрощает разработку и поддержку системы.</p>

        <h2>Компоненты системы</h2>
        
        <h3>1. Модели данных (Models)</h3>
        <ul>
            <li><strong>Operator:</strong> Операторы ДБО (два типа)</li>
            <li><strong>Client:</strong> Клиенты банка</li>
            <li><strong>Service:</strong> Банковские услуги</li>
            <li><strong>ServiceCategory:</strong> Категории услуг</li>
            <li><strong>BankCard:</strong> Банковские карты</li>
            <li><strong>Transaction:</strong> Финансовые транзакции</li>
        </ul>

        <h3>2. Представления (Views)</h3>
        <ul>
            <li><strong>home:</strong> Главная страница</li>
            <li><strong>banking_services:</strong> Каталог услуг</li>
            <li><strong>client_dashboard:</strong> Панель клиента</li>
            <li><strong>operator1_dashboard:</strong> Панель оператора ДБО #1</li>
            <li><strong>operator2_dashboard:</strong> Панель оператора ДБО #2</li>
        </ul>

        <h3>3. Шаблоны (Templates)</h3>
        <ul>
            <li><strong>base.html:</strong> Базовый шаблон</li>
            <li><strong>index.html:</strong> Главная страница</li>
            <li><strong>dashboard.html:</strong> Дашборды</li>
            <li><strong>banking_services.html:</strong> Каталог услуг</li>
        </ul>

        <h1 id="models">3. Модели данных</h1>

        <h2>Operator (Операторы ДБО)</h2>
        <div class="code-block">
class Operator(models.Model):
    user = models.OneToOneField(User, on_delete=models.CASCADE)
    operator_type = models.CharField(max_length=50, choices=[
        ('client_service', 'Оператор ДБО #1 (Отдел клиентского обслуживания)'),
        ('security', 'Оператор ДБО #2 (Отдел безопасности/валидации)'),
    ])
    email = models.EmailField()
    is_active = models.BooleanField(default=True)
    created_at = models.DateTimeField(auto_now_add=True)
        </div>
        <p><strong>Назначение:</strong> Управление операторами системы с разделением ролей.</p>

        <h2>Client (Клиенты)</h2>
        <div class="code-block">
class Client(models.Model):
    user = models.OneToOneField(User, on_delete=models.CASCADE)
    client_id = models.CharField(max_length=20, unique=True)
    full_name = models.CharField(max_length=200)
    email = models.EmailField()
    phone = models.CharField(max_length=20, unique=True)
    is_active = models.BooleanField(default=True)
    primary_card = models.ForeignKey('BankCard', on_delete=models.SET_NULL, null=True, blank=True)
    created_by = models.ForeignKey(Operator, on_delete=models.SET_NULL, null=True, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)
        </div>
        <p><strong>Назначение:</strong> Хранение информации о клиентах банка.</p>

        <h1 id="security">5. Безопасность</h1>

        <h2>Уязвимости для тестирования</h2>

        <h3>1. SQL-инъекция в banking_services</h3>
        <p><strong>Расположение:</strong> dbo/views.py, функция banking_services</p>
        
        <div class="warning">
            <strong>Код уязвимости:</strong>
        </div>
        
        <div class="code-block">
# ОПАСНО: Прямая конкатенация без параметризации
if q:
    where_clauses.append(f"(s.name LIKE '%{q}%' OR s.description LIKE '%{q}%')")

if category_name:
    where_clauses.append(f"c.name = '{category_name}'")
        </div>

        <p><strong>Эксплойт:</strong></p>
        <div class="code-block">
-- Поиск: ' OR '1'='1' --
-- Категория: '; DROP TABLE dbo_service; --
        </div>

        <h3>2. XSS в ServiceRequest</h3>
        <p><strong>Расположение:</strong> dbo/models.py, поле service_description</p>
        <p><strong>Описание:</strong> Поле service_description в модели ServiceRequest не экранируется при отображении, что позволяет внедрить JavaScript код.</p>
        
        <p><strong>Эксплойт:</strong></p>
        <div class="code-block">
&lt;script&gt;alert('XSS Attack!')&lt;/script&gt;
        </div>

        <h1 id="installation">6. Установка и настройка</h1>

        <h2>Требования</h2>
        <ul>
            <li>Python 3.13+</li>
            <li>Django 5.2.7</li>
            <li>PostgreSQL (для продакшна)</li>
            <li>Node.js (для сборки статических файлов)</li>
        </ul>

        <h2>Установка</h2>
        <ol>
            <li>Клонирование репозитория: <code>git clone &lt;repository-url&gt;</code></li>
            <li>Создание виртуального окружения: <code>python -m venv venv</code></li>
            <li>Установка зависимостей: <code>pip install -r requirements.txt</code></li>
            <li>Настройка базы данных: <code>python manage.py migrate</code></li>
            <li>Создание суперпользователя: <code>python manage.py createsuperuser</code></li>
            <li>Инициализация демо-данных: <code>python init_data.py</code></li>
            <li>Запуск сервера: <code>python manage.py runserver</code></li>
        </ol>

        <h1>Заключение</h1>
        
        <p>Система ДБО "ФинансПро" представляет собой комплексное решение для дистанционного банковского обслуживания с современной архитектурой и широкими возможностями настройки. Система включает в себя все необходимые компоненты для полноценного банковского сервиса и может быть легко адаптирована под конкретные требования.</p>

        <h2>Основные преимущества</h2>
        <ul>
            <li><strong>Масштабируемость:</strong> Архитектура позволяет легко добавлять новые функции</li>
            <li><strong>Безопасность:</strong> Многоуровневая система защиты с возможностью тестирования уязвимостей</li>
            <li><strong>Гибкость:</strong> Модульная структура упрощает кастомизацию</li>
            <li><strong>Производительность:</strong> Оптимизированные запросы и кэширование</li>
        </ul>

        <div class="footer">
            <p>© 2024 Система ДБО "ФинансПро". Все права защищены.</p>
        </div>
    </div>
</body>
</html>
