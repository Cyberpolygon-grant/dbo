from django.core.management.base import BaseCommand
from dbo.models import ServiceCategory, Service

class Command(BaseCommand):
    help = 'Создает демонстрационные банковские услуги'

    def handle(self, *args, **options):
        # Создаем категории услуг
        categories_data = [
            {
                'name': 'Расчетно-кассовое обслуживание',
                'description': 'Открытие и ведение расчетных счетов, проведение платежей и переводов'
            },
            {
                'name': 'Кредитные продукты',
                'description': 'Потребительские кредиты, кредитные карты, ипотека на выгодных условиях'
            },
            {
                'name': 'Депозитные программы',
                'description': 'Выгодные депозиты с высокими процентными ставками и гибкими условиями'
            },
            {
                'name': 'Переводы и платежи',
                'description': 'Мгновенные переводы между счетами, оплата услуг и коммунальных платежей'
            },
            {
                'name': 'Банковские карты',
                'description': 'Дебетовые и кредитные карты с кэшбэком и бонусными программами'
            },
            {
                'name': 'Инвестиционные продукты',
                'description': 'Индивидуальные инвестиционные счета, ПИФы и доверительное управление'
            }
        ]

        # Создаем категории
        for cat_data in categories_data:
            category, created = ServiceCategory.objects.get_or_create(
                name=cat_data['name'],
                defaults={'description': cat_data['description']}
            )
            if created:
                self.stdout.write(f'Создана категория: {category.name}')

        # Создаем услуги
        services_data = [
            # Расчетно-кассовое обслуживание
            {
                'name': 'Открытие расчетного счета',
                'description': 'Открытие расчетного счета для физических лиц с полным пакетом банковских услуг',
                'category': 'Расчетно-кассовое обслуживание',
                'price': 0
            },
            {
                'name': 'Корпоративное обслуживание',
                'description': 'Комплексное банковское обслуживание для юридических лиц и ИП',
                'category': 'Расчетно-кассовое обслуживание',
                'price': 5000
            },
            {
                'name': 'Зарплатный проект',
                'description': 'Автоматическое зачисление заработной платы сотрудников на банковские карты',
                'category': 'Расчетно-кассовое обслуживание',
                'price': 0
            },

            # Кредитные продукты
            {
                'name': 'Потребительский кредит',
                'description': 'Кредит наличными до 5 млн рублей под 12.9% годовых',
                'category': 'Кредитные продукты',
                'price': 0
            },
            {
                'name': 'Кредитная карта',
                'description': 'Кредитная карта с льготным периодом до 55 дней и кэшбэком до 5%',
                'category': 'Кредитные продукты',
                'price': 0
            },
            {
                'name': 'Ипотечный кредит',
                'description': 'Ипотека на покупку недвижимости от 8.5% годовых',
                'category': 'Кредитные продукты',
                'price': 0
            },
            {
                'name': 'Автокредит',
                'description': 'Кредит на покупку автомобиля от 7.9% годовых',
                'category': 'Кредитные продукты',
                'price': 0
            },

            # Депозитные программы
            {
                'name': 'Сберегательный депозит',
                'description': 'Депозит до 8% годовых с возможностью пополнения',
                'category': 'Депозитные программы',
                'price': 0
            },
            {
                'name': 'Накопительный счет',
                'description': 'Накопительный счет с капитализацией процентов',
                'category': 'Депозитные программы',
                'price': 0
            },
            {
                'name': 'Депозит "Максимальный доход"',
                'description': 'Депозит на 12 месяцев под 9.5% годовых без возможности досрочного снятия',
                'category': 'Депозитные программы',
                'price': 0
            },

            # Переводы и платежи
            {
                'name': 'Переводы между счетами',
                'description': 'Мгновенные переводы между счетами клиентов банка',
                'category': 'Переводы и платежи',
                'price': 0
            },
            {
                'name': 'Переводы в другие банки',
                'description': 'Переводы в другие банки России через систему быстрых платежей',
                'category': 'Переводы и платежи',
                'price': 15
            },
            {
                'name': 'Оплата ЖКХ',
                'description': 'Автоматическая оплата коммунальных услуг по расписанию',
                'category': 'Переводы и платежи',
                'price': 0
            },
            {
                'name': 'Оплата мобильной связи',
                'description': 'Пополнение баланса мобильного телефона с кэшбэком 2%',
                'category': 'Переводы и платежи',
                'price': 0
            },

            # Банковские карты
            {
                'name': 'Дебетовая карта "Стандарт"',
                'description': 'Основная дебетовая карта с кэшбэком 1% на все покупки',
                'category': 'Банковские карты',
                'price': 0
            },
            {
                'name': 'Дебетовая карта "Премиум"',
                'description': 'Премиальная карта с кэшбэком до 5% и приоритетным обслуживанием',
                'category': 'Банковские карты',
                'price': 5000
            },
            {
                'name': 'Виртуальная карта',
                'description': 'Виртуальная карта для безопасных онлайн-покупок',
                'category': 'Банковские карты',
                'price': 0
            },
            {
                'name': 'Мультивалютная карта',
                'description': 'Карта для работы с несколькими валютами без конвертации',
                'category': 'Банковские карты',
                'price': 2000
            },

            # Инвестиционные продукты
            {
                'name': 'Индивидуальный инвестиционный счет',
                'description': 'ИИС с налоговыми льготами для долгосрочного инвестирования',
                'category': 'Инвестиционные продукты',
                'price': 0
            },
            {
                'name': 'ПИФ "Консервативный"',
                'description': 'Паевой инвестиционный фонд с низким уровнем риска',
                'category': 'Инвестиционные продукты',
                'price': 1000
            },
            {
                'name': 'ПИФ "Агрессивный"',
                'description': 'Паевой инвестиционный фонд с высоким потенциалом доходности',
                'category': 'Инвестиционные продукты',
                'price': 1000
            },
            {
                'name': 'Доверительное управление',
                'description': 'Профессиональное управление инвестиционным портфелем',
                'category': 'Инвестиционные продукты',
                'price': 0
            }
        ]

        # Создаем услуги
        for service_data in services_data:
            try:
                category = ServiceCategory.objects.get(name=service_data['category'])
                service, created = Service.objects.get_or_create(
                    name=service_data['name'],
                    defaults={
                        'description': service_data['description'],
                        'category': category,
                        'price': service_data['price']
                    }
                )
                if created:
                    self.stdout.write(f'Создана услуга: {service.name}')
            except ServiceCategory.DoesNotExist:
                self.stdout.write(f'Категория не найдена: {service_data["category"]}')

        self.stdout.write(
            self.style.SUCCESS('Демонстрационные банковские услуги успешно созданы!')
        )
