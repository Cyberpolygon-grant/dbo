{% extends "base.html" %}

{% block title %}–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <div class="hero bg-gradient-to-r from-secondary to-accent text-primary-content rounded-lg mb-8">
        <div class="hero-content text-center">
            <div class="max-w-md">
                <h1 class="text-4xl font-bold mb-4">–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã</h1>
                <p class="text-lg opacity-90">–î–µ–±–µ—Ç–æ–≤—ã–µ –∏ –∫—Ä–µ–¥–∏—Ç–Ω—ã–µ –∫–∞—Ä—Ç—ã —Å –∫—ç—à–±—ç–∫–æ–º –∏ –±–æ–Ω—É—Å–Ω—ã–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏</p>
                <div class="badge badge-lg badge-accent mt-4">–î–æ 5% –∫—ç—à–±—ç–∫</div>
            </div>
        </div>
    </div>

    <!-- –¢–∏–ø—ã –∫–∞—Ä—Ç -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
        <!-- –î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞ -->
        <div class="card bg-base-100 shadow-xl">
            <div class="card-body">
                <h2 class="card-title text-primary">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                    </svg>
                    –î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞
                </h2>
                <p class="text-base-content/70">–û–ø–ª–∞—á–∏–≤–∞–π—Ç–µ –ø–æ–∫—É–ø–∫–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏</p>
                <div class="stats stats-vertical shadow">
                    <div class="stat">
                        <div class="stat-title">–ö—ç—à–±—ç–∫ –¥–æ</div>
                        <div class="stat-value text-primary">5%</div>
                        <div class="stat-desc">–Ω–∞ –≤—Å–µ –ø–æ–∫—É–ø–∫–∏</div>
                    </div>
                    <div class="stat">
                        <div class="stat-title">–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</div>
                        <div class="stat-value text-secondary">0 ‚ÇΩ</div>
                        <div class="stat-desc">–≤ –≥–æ–¥</div>
                    </div>
                </div>
                <div class="card-actions justify-end">
                    <button class="btn btn-primary" onclick="openCardModal('debit')">–û—Ñ–æ—Ä–º–∏—Ç—å –∫–∞—Ä—Ç—É</button>
                </div>
            </div>
        </div>

        <!-- –ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞ -->
        <div class="card bg-base-100 shadow-xl">
            <div class="card-body">
                <h2 class="card-title text-secondary">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    –ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞
                </h2>
                <p class="text-base-content/70">–ü–æ–∫—É–ø–∞–π—Ç–µ —Å–µ–π—á–∞—Å, –ø–ª–∞—Ç–∏—Ç–µ –ø–æ—Ç–æ–º</p>
                <div class="stats stats-vertical shadow">
                    <div class="stat">
                        <div class="stat-title">–õ–∏–º–∏—Ç –¥–æ</div>
                        <div class="stat-value text-primary">500 000 ‚ÇΩ</div>
                        <div class="stat-desc">–Ω–∞ –∫–∞—Ä—Ç–µ</div>
                    </div>
                    <div class="stat">
                        <div class="stat-title">–õ—å–≥–æ—Ç–Ω—ã–π –ø–µ—Ä–∏–æ–¥</div>
                        <div class="stat-value text-secondary">55</div>
                        <div class="stat-desc">–¥–Ω–µ–π</div>
                    </div>
                </div>
                <div class="card-actions justify-end">
                    <button class="btn btn-secondary" onclick="openCardModal('credit')">–û—Ñ–æ—Ä–º–∏—Ç—å –∫–∞—Ä—Ç—É</button>
                </div>
            </div>
        </div>

        <!-- –ü—Ä–µ–º–∏—É–º –∫–∞—Ä—Ç–∞ -->
        <div class="card bg-base-100 shadow-xl">
            <div class="card-body">
                <h2 class="card-title text-accent">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path>
                    </svg>
                    –ü—Ä–µ–º–∏—É–º –∫–∞—Ä—Ç–∞
                </h2>
                <p class="text-base-content/70">–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã</p>
                <div class="stats stats-vertical shadow">
                    <div class="stat">
                        <div class="stat-title">–ö—ç—à–±—ç–∫ –¥–æ</div>
                        <div class="stat-value text-primary">7%</div>
                        <div class="stat-desc">–Ω–∞ –≤—Å–µ –ø–æ–∫—É–ø–∫–∏</div>
                    </div>
                    <div class="stat">
                        <div class="stat-title">–ü—Ä–∏–≤–∏–ª–µ–≥–∏–∏</div>
                        <div class="stat-value text-secondary">VIP</div>
                        <div class="stat-desc">—Å–µ—Ä–≤–∏—Å</div>
                    </div>
                </div>
                <div class="card-actions justify-end">
                    <button class="btn btn-accent" onclick="openCardModal('premium')">–û—Ñ–æ—Ä–º–∏—Ç—å –∫–∞—Ä—Ç—É</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–∏ –∫–∞—Ä—Ç—ã -->
    <div class="card bg-base-100 shadow-xl mb-8">
        <div class="card-body">
            <h2 class="card-title text-2xl mb-4">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                </svg>
                –ú–æ–∏ –∫–∞—Ä—Ç—ã
            </h2>
            
            {% if cards %}
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                {% for card in cards %}
                <div class="card bg-gradient-to-br from-primary to-secondary text-primary-content shadow-xl">
                    <div class="card-body">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="card-title text-lg">
                                    {% if card.card_type == 'debit' %}–î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞
                                    {% elif card.card_type == 'credit' %}–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞
                                    {% endif %}
                                </h3>
                                <p class="text-sm opacity-90">{{ card.account.client.full_name }}</p>
                            </div>
                            <div class="badge badge-outline">{{ card.account.account_number|slice:"-4:" }}****</div>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-2xl font-mono tracking-wider">{{ card.card_number }}</p>
                            <p class="text-sm opacity-90">–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è: {{ card.expiry_date|date:"m/Y" }}</p>
                        </div>
                        
                        <div class="flex justify-between items-center">
                            <div>
                                {% if card.is_active %}
                                    <span class="badge badge-success">–ê–∫—Ç–∏–≤–Ω–∞</span>
                                {% else %}
                                    <span class="badge badge-error">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞</span>
                                {% endif %}
                            </div>
                            <div class="card-actions">
                                <button class="btn btn-sm btn-primary" onclick="viewCardDetails({{ card.id }})">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</button>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center py-8">
                <svg class="w-16 h-16 mx-auto text-base-content/30 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                </svg>
                <h3 class="text-xl font-semibold mb-2">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∫–∞—Ä—Ç</h3>
                <p class="text-base-content/70 mb-4">–û—Ñ–æ—Ä–º–∏—Ç–µ –±–∞–Ω–∫–æ–≤—Å–∫—É—é –∫–∞—Ä—Ç—É –¥–ª—è —É–¥–æ–±–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π</p>
                <button class="btn btn-primary" onclick="openCardModal('debit')">–û—Ñ–æ—Ä–º–∏—Ç—å –∫–∞—Ä—Ç—É</button>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–∞–º–∏ -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
        <!-- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ -->
        <div class="card bg-base-100 shadow-xl">
            <div class="card-body">
                <h2 class="card-title text-xl mb-4">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
                    </svg>
                    –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–∞—Ä—Ç—ã
                </h2>
                <p class="text-base-content/70 mb-4">–ó–∞–±–ª–æ–∫–∏—Ä—É–π—Ç–µ –∫–∞—Ä—Ç—É –ø—Ä–∏ —É—Ç–µ—Ä–µ –∏–ª–∏ –∫—Ä–∞–∂–µ</p>
                <div class="card-actions">
                    <button class="btn btn-error" onclick="blockCard()">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç—É</button>
                </div>
            </div>
        </div>

        <!-- –°–º–µ–Ω–∞ PIN -->
        <div class="card bg-base-100 shadow-xl">
            <div class="card-body">
                <h2 class="card-title text-xl mb-4">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path>
                    </svg>
                    –°–º–µ–Ω–∞ PIN-–∫–æ–¥–∞
                </h2>
                <p class="text-base-content/70 mb-4">–ò–∑–º–µ–Ω–∏—Ç–µ PIN-–∫–æ–¥ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</p>
                <div class="card-actions">
                    <button class="btn btn-warning" onclick="changePin()">–°–º–µ–Ω–∏—Ç—å PIN</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ë–æ–Ω—É—Å—ã –∏ –∫—ç—à–±—ç–∫ -->
    <div class="card bg-base-100 shadow-xl mb-8">
        <div class="card-body">
            <h2 class="card-title text-2xl mb-4">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                </svg>
                –ë–æ–Ω—É—Å—ã –∏ –∫—ç—à–±—ç–∫
            </h2>
            <div class="stats stats-vertical shadow">
                <div class="stat">
                    <div class="stat-title">–ù–∞–∫–æ–ø–ª–µ–Ω–æ –∫—ç—à–±—ç–∫–∞</div>
                    <div class="stat-value text-primary">1 250 ‚ÇΩ</div>
                    <div class="stat-desc">–∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü</div>
                </div>
                <div class="stat">
                    <div class="stat-title">–ë–æ–Ω—É—Å–Ω—ã—Ö –±–∞–ª–ª–æ–≤</div>
                    <div class="stat-value text-secondary">15 600</div>
                    <div class="stat-desc">–¥–æ—Å—Ç—É–ø–Ω–æ –∫ —Å–ø–∏—Å–∞–Ω–∏—é</div>
                </div>
                <div class="stat">
                    <div class="stat-title">–°–ª–µ–¥—É—é—â–∏–π –∫—ç—à–±—ç–∫</div>
                    <div class="stat-value text-accent">5%</div>
                    <div class="stat-desc">–Ω–∞ –ø–æ–∫—É–ø–∫–∏ –≤ —Å—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç–∞—Ö</div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ -->
    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <h2 class="card-title text-2xl mb-6">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–∞—à–∏—Ö –∫–∞—Ä—Ç</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="text-center">
                    <div class="text-3xl mb-2">üí∞</div>
                    <h3 class="font-semibold mb-1">–ö—ç—à–±—ç–∫</h3>
                    <p class="text-sm text-base-content/70">–î–æ 5% –Ω–∞ –≤—Å–µ –ø–æ–∫—É–ø–∫–∏</p>
                </div>
                <div class="text-center">
                    <div class="text-3xl mb-2">üîí</div>
                    <h3 class="font-semibold mb-1">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h3>
                    <p class="text-sm text-base-content/70">3D Secure, SMS-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</p>
                </div>
                <div class="text-center">
                    <div class="text-3xl mb-2">üì±</div>
                    <h3 class="font-semibold mb-1">–ú–æ–±–∏–ª—å–Ω—ã–π –±–∞–Ω–∫</h3>
                    <p class="text-sm text-base-content/70">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</p>
                </div>
                <div class="text-center">
                    <div class="text-3xl mb-2">üåç</div>
                    <h3 class="font-semibold mb-1">–ü—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –≤–µ–∑–¥–µ</h3>
                    <p class="text-sm text-base-content/70">Visa, Mastercard</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∫–∞—Ä—Ç—ã -->
<div id="cardModal" class="modal">
    <div class="modal-box">
        <h3 class="font-bold text-lg mb-4" id="cardModalTitle">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã</h3>
        <form id="cardForm">
            <div class="form-control mb-4">
                <label class="label">
                    <span class="label-text">–¢–∏–ø –∫–∞—Ä—Ç—ã</span>
                </label>
                <select class="select select-bordered" name="card_type" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–∞—Ä—Ç—ã</option>
                    <option value="debit">–î–µ–±–µ—Ç–æ–≤–∞—è –∫–∞—Ä—Ç–∞</option>
                    <option value="credit">–ö—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞</option>
                </select>
            </div>
            <div class="form-control mb-4">
                <label class="label">
                    <span class="label-text">–°—á–µ—Ç –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏</span>
                </label>
                <select class="select select-bordered" name="account" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å—á–µ—Ç</option>
                    {% for account in accounts %}
                        <option value="{{ account.id }}">{{ account.account_number }} ({{ account.balance|floatformat:0 }} ‚ÇΩ)</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-control mb-4">
                <label class="label">
                    <span class="label-text">–î–æ—Å—Ç–∞–≤–∫–∞ –∫–∞—Ä—Ç—ã</span>
                </label>
                <select class="select select-bordered" name="delivery" required>
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏</option>
                    <option value="office">–í –æ—Ñ–∏—Å –±–∞–Ω–∫–∞</option>
                    <option value="courier">–ö—É—Ä—å–µ—Ä–æ–º</option>
                    <option value="post">–ü–æ—á—Ç–æ–π</option>
                </select>
            </div>
            <div class="form-control mb-4">
                <label class="label">
                    <span class="label-text">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏</span>
                </label>
                <textarea class="textarea textarea-bordered" name="address" placeholder="–£–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏" required></textarea>
            </div>
            <div class="modal-action">
                <button type="button" class="btn btn-ghost" onclick="closeCardModal()">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" class="btn btn-primary">–û—Ñ–æ—Ä–º–∏—Ç—å –∫–∞—Ä—Ç—É</button>
            </div>
        </form>
    </div>
</div>

<script>
function openCardModal(type) {
    const modal = document.getElementById('cardModal');
    const title = document.getElementById('cardModalTitle');
    
    switch(type) {
        case 'debit':
            title.textContent = '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –¥–µ–±–µ—Ç–æ–≤–æ–π –∫–∞—Ä—Ç—ã';
            break;
        case 'credit':
            title.textContent = '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∫–∞—Ä—Ç—ã';
            break;
        case 'premium':
            title.textContent = '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ø—Ä–µ–º–∏—É–º –∫–∞—Ä—Ç—ã';
            break;
    }
    
    modal.classList.add('modal-open');
}

function closeCardModal() {
    document.getElementById('cardModal').classList.remove('modal-open');
}

function viewCardDetails(cardId) {
    showAlert('–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ–π #' + cardId, 'info');
}

function blockCard() {
    confirmAction(
        '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ä—Ç—É?',
        function() {
            showAlert('–ö–∞—Ä—Ç–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞. –î–ª—è —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –±–∞–Ω–∫.', 'warning');
        }
    );
}

function changePin() {
    // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –≤–≤–æ–¥–∞ PIN-–∫–æ–¥–∞
    const modal = document.createElement('div');
    modal.className = 'modal modal-open';
    modal.style.zIndex = '10000';
    
    modal.innerHTML = `
        <div class="modal-box">
            <h3 class="font-bold text-lg mb-4">–ò–∑–º–µ–Ω–µ–Ω–∏–µ PIN-–∫–æ–¥–∞</h3>
            <p class="py-4">–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π PIN-–∫–æ–¥ (4 —Ü–∏—Ñ—Ä—ã):</p>
            <input type="password" id="pin-input" class="input input-bordered w-full max-w-xs" maxlength="4" pattern="[0-9]{4}" placeholder="0000">
            <div class="modal-action">
                <button class="btn btn-primary" id="confirm-pin-btn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                <button class="btn btn-ghost" id="cancel-pin-btn">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
        <div class="modal-backdrop" id="pin-modal-backdrop"></div>
    `;
    
    document.body.appendChild(modal);
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    document.getElementById('confirm-pin-btn').onclick = function() {
        const newPin = document.getElementById('pin-input').value;
        if (newPin && newPin.length === 4 && /^\d+$/.test(newPin)) {
            showAlert('PIN-–∫–æ–¥ —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω!', 'success');
            modal.remove();
        } else {
            showAlert('PIN-–∫–æ–¥ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 4 —Ü–∏—Ñ—Ä—ã', 'warning');
        }
    };
    
    document.getElementById('cancel-pin-btn').onclick = function() {
        modal.remove();
    };
    
    document.getElementById('pin-modal-backdrop').onclick = function() {
        modal.remove();
    };
}

// –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∫–∞—Ä—Ç—ã
document.getElementById('cardForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const formData = new FormData(this);
    
    showAlert('–ó–∞—è–≤–∫–∞ –Ω–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –ö–∞—Ä—Ç–∞ –±—É–¥–µ—Ç –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 5-7 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π.', 'success');
    closeCardModal();
    this.reset();
});
</script>
{% endblock %}